## 📚 C指针声明解析大全（从入门到复杂类型）

---

[TOC]



### **1️⃣ 核心解析规则**

🚩 **优先级顺序**：`() > [] > *`  
🚩 **解析口诀**：**从标识符出发，先右后左，括号优先**  

---

### **2️⃣ 基础类型与指针**

#### 📌 示例1：普通变量

```c
int p;
```
- **解析**：`p` 是整型变量  
- **内存图**：`[p] -> int`

---

#### 📌 示例2：一级指针  
```c
int *p;
```
- **解析步骤**：  
  1. `p` 先与 `*` 结合 → 指针  
  2. 指向 `int` 类型  
- **结论**：`p` 是**整型指针**  
- **内存图**：`[p] -> [int]`

---

### **3️⃣ 数组与指针**

#### 📌 示例3：一维数组  
```c
int p[3];
```
- **解析步骤**：  
  1. `p` 先与 `[3]` 结合 → 数组  
  2. 元素类型为 `int`  
- **结论**：`p` 是**整型数组**（长度3）  
- **内存图**：`[p[0] | p[1] | p[2]] -> int`

---

#### 📌 示例4：指针数组  
```c
int *p[3];
```
- **解析步骤**：  
  1. `p` 先与 `[3]` 结合 → 数组  
  2. 元素类型为 `int*`（指针）  
- **结论**：`p` 是**整型指针数组**  
- **内存图**：  
  ```text
  [p[0] -> int]  
  [p[1] -> int]  
  [p[2] -> int]  
  ```

---

#### 📌 示例5：数组指针  
```c
int (*p)[3];
```
- **解析步骤**：  
  1. `p` 先与 `*` 结合 → 指针  
  2. 指向 `int[3]` 类型（数组）  
- **结论**：`p` 是**指向整型数组的指针**  
- **内存图**：`p -> [int | int | int]`

---

### **4️⃣ 多级指针**

#### 📌 示例6：二级指针  
```c
int **p;
```
- **解析步骤**：  
  1. `p` 是 `**` 结合 → 二级指针  
  2. 最终指向 `int` 类型  
- **结论**：`p` 是**指向整型指针的指针**  
- **内存图**：`p -> [int*] -> [int]`

---

### **5️⃣ 函数与指针**

#### 📌 示例7：函数声明  
```c
int p(int);
```
- **解析步骤**：  
  1. `p` 与 `(int)` 结合 → 函数  
  2. 参数为 `int`，返回 `int`  
- **结论**：`p` 是**函数**，原型 `int p(int)`  

---

#### 📌 示例8：函数指针  
```c
int (*p)(int);
```
- **解析步骤**：  
  1. `p` 先与 `*` 结合 → 指针  
  2. 指向 `int(int)` 类型（函数）  
- **结论**：`p` 是**函数指针**，指向 `int func(int)`  
- **使用示例**：  
  ```c
  int add(int a) { return a + 1; }
  p = add;  // 指向函数
  int result = p(5); // 调用函数 → 6
  ```

---

### **6️⃣ 复杂类型解析**

#### 📌 示例9：函数返回指针数组  
```c
int *(*p(int))[3];
```
- **解析步骤**（由内向外）：  
  1. `p(int)` → `p` 是函数，参数为 `int`  
  2. `*p(int)` → 函数返回指针  
  3. `(*p(int))[3]` → 指针指向长度3的数组  
  4. `int*` → 数组元素是整型指针  
- **结论**：  
  `p` 是**函数**，接受 `int` 参数，返回指向 `int*[3]` 的指针  
- **等效分解**：  
  ```c
  typedef int* IntPtrArray[3];  // 定义数组类型
  IntPtrArray* p(int);          // 函数返回数组指针
  ```

---

### **7️⃣ 解析技巧总结**

| 符号 | 解析方向 | 说明                       |
| ---- | -------- | -------------------------- |
| `[]` | 向右     | 标识符先与右侧的 `[]` 结合 |
| `()` | 向右     | 函数参数或优先级调整       |
| `*`  | 向左     | 左侧无符号时与左侧类型结合 |

---

### **8️⃣ 实战训练**

#### 🔍 练习1：解析声明  
```c
void (*signal(int sig, void (*handler)(int)))(int);
```
- **提示**：`signal` 是函数，参数为 `int` 和函数指针，返回函数指针。

#### 🔍 练习2：编写声明  
- **要求**：声明一个数组，元素为指向函数的指针，函数接受 `char*` 并返回 `float`。  
- **答案**：  
  ```c
  float (*funcArray[5])(char*);
  ```

---

### **9️⃣ 常见误区**

| 误区                       | 正确理解         |
| -------------------------- | ---------------- |
| `int *p[3]` 是指针数组     | ✅ 数组元素为指针 |
| `int (*p)[3]` 是数组指针   | ✅ 指针指向数组   |
| `int* p, q;` 中 `q` 是指针 | ❌ `q` 是整型变量 |

---

通过系统化解析训练，可快速掌握复杂指针声明！ 🚀
